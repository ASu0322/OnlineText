module.exports=function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=9)}([function(e,r,t){"use strict";var n=t(2),o=t.n(n);t(11).config();const s=o.a.object().keys({NODE_ENV:o.a.string().default("development").allow(["development","production"]),PORT:o.a.number().default(8080),MYSQL_PORT:o.a.number().default(3306),MYSQL_HOST:o.a.string().default("127.0.0.1"),MYSQL_USER:o.a.string(),MYSQL_PASS:o.a.string(),MYSQL_NAME:o.a.string(),VERSION:o.a.string()}).unknown().required(),{error:a,value:i}=o.a.validate(process.env,s);if(a)throw new Error("Config validation error: "+a.message);const c={version:i.VERSION,env:i.NODE_ENV,port:i.PORT,mysqlPort:i.MYSQL_PORT,mysqlHost:i.MYSQL_HOST,mysqlUserName:i.MYSQL_USER,mysqlPass:i.MYSQL_PASS,mysqlDatabase:i.MYSQL_DATABASE};r.a=c},function(e,r){e.exports=require("express")},function(e,r){e.exports=require("joi")},function(e,r,t){"use strict";(function(e){var n=t(1),o=t.n(n),s=t(0),a=t(8),i=t(5),c=t.n(i),u=t(6),l=t.n(u),d=t(7),f=t.n(d);const p=o()();p.use(c.a.json()),p.use(c.a.urlencoded({extended:!0})),p.use(l()()),p.use(f()("dev")),p.get("/",(e,r)=>{r.send(`server started express on  port http://127.0.0.1:${s.a.port} (${s.a.env})`)}),p.use("/OnlineText",a.a);const g=t(12);p.use(o.a.static(g.join(g.join(e,"OnlineText"),"public"))),r.a=p}).call(this,"/")},function(e,r){e.exports=require("mysql")},function(e,r){e.exports=require("body-parser")},function(e,r){e.exports=require("cors")},function(e,r){e.exports=require("morgan")},function(e,r,t){"use strict";var n=t(1),o=t.n(n),s=t(0),a=t(4),i=t.n(a);const c=i.a.createPool({connection:10,host:s.a.mysqlHost,user:s.a.mysqlUserName,password:s.a.mysqlPass,database:s.a.mysqlDatabase});var u=e=>new Promise((r,t)=>{c.getConnection((n,o)=>{n?t(n):(o.query("Select user_password From account Where user_account = ?",e.user_account,(n,o)=>{n?(console.error("SQL error:",n),t(n)):o[0].user_password===e.user_password?(console.log(e),r("success login")):r("fail login")}),o.release())})});var l=(e,r)=>{const t=e.body;u(t).then(e=>{"success login"===e?(r.redirect("main_Page"),console.log("success")):"fail login"===e&&(r.render("login",{success:!1}),console.log("fail"))}).catch(e=>{"ER_DUP_ENTRY"===e.code?r.render("login",{success:!0}):r.send(e)})};const d=o.a.Router();d.route("/").post(l),d.get("/",(e,r)=>{r.render("login")});var f=d;const p=i.a.createPool({connection:10,host:s.a.mysqlHost,user:s.a.mysqlUserName,password:s.a.mysqlPass,database:s.a.mysqlDatabase});var g=e=>new Promise((r,t)=>{p.getConnection((n,o)=>{n?t(n):(o.query("insert INTO Account SET ?",{user_account:e.user_account,user_password:e.user_password},(e,n)=>{e?(console.error("SQL error:",e),t(e)):(console.log("成功新增~~~~~~~~~~"),r("新增成功! account_id: "+n.insertID))}),o.release())})});var v=(e,r)=>{const t=e.body;g(t).then(e=>{r.redirect("verification")}).catch(e=>{"ER_DUP_ENTRY"===e.code?(console.log("fail~~~_double"),r.render("register",{success:!1})):r.send(e)})};const m=o.a.Router();m.route("/").post(v),m.get("/",(e,r)=>{r.render("register")});var y=m;const b=o.a.Router();b.get("/",(e,r)=>{r.render("welcome")});var _=b;const S=o.a.Router();S.get("/",(e,r)=>{r.render("verification")});var P=S;const q=o.a.Router();q.get("/",(e,r)=>{r.send(`此路徑是: losdfsfdfcalhost:${s.a.port}/api`)}),q.use("/login",f),q.use("/register",y),q.use("/main_Page",_),q.use("/verification",P);r.a=q},function(e,r,t){"use strict";t.r(r),function(e){var n=t(0),o=t(3);e.parent||(o.a.set("views","./views"),o.a.set("view engine","jade"),o.a.listen(n.a.port,()=>{console.log(`server started on port http://127.0.\n        0.1:${n.a.port} (${n.a.env})`)})),r.default=o.a}.call(this,t(10)(e))},function(e,r){e.exports=function(e){if(!e.webpackPolyfill){var r=Object.create(e);r.children||(r.children=[]),Object.defineProperty(r,"loaded",{enumerable:!0,get:function(){return r.l}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return r.i}}),Object.defineProperty(r,"exports",{enumerable:!0}),r.webpackPolyfill=1}return r}},function(e,r){e.exports=require("dotenv")},function(e,r){e.exports=require("path")}]);
//# sourceMappingURL=index.bundle.js.map